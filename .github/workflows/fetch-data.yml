name: Fetch Boat Race Data

on:
  # ğŸ” æ¯æ™© 22:00ï¼ˆæ—¥æœ¬æ™‚é–“ 07:00ï¼‰ã«è‡ªå‹•å®Ÿè¡Œ
  schedule:
    - cron: "0 22 * * *"

  # â–¶ï¸ GitHub Actions ãƒšãƒ¼ã‚¸ã‹ã‚‰æ‰‹å‹•å®Ÿè¡Œå¯èƒ½
  workflow_dispatch:

jobs:
  fetch:
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ ãƒªãƒã‚¸ãƒˆãƒªã‚’å–å¾—
        uses: actions/checkout@v4

      - name: ğŸ Python ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      - name: ğŸ“¦ ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
        run: |
          pip install requests
          pip install beautifulsoup4
          pip install lxml
          pip install pandas

      - name: ğŸš€ ãƒ‡ãƒ¼ã‚¿å–å¾—ã‚’å®Ÿè¡Œ
        run: |
          echo "ğŸ“… 60æ—¥åˆ†ã®ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã„ã¾ã™..."
          python fetch_data.py

      - name: ğŸ’¾ ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã‚’ã‚³ãƒŸãƒƒãƒˆï¼†ãƒ—ãƒƒã‚·ãƒ¥
        run: |
          git config --local user.email "actions@github.com"
          git config --local user.name "github-actions[bot]"
          git add data.json history.json features.csv || true
          git commit -m "ğŸ è‡ªå‹•æ›´æ–°: æœ€æ–°ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿å–å¾—" || echo "No changes to commit"
          git push

      - name: âœ… å®Œäº†ãƒ­ã‚°
        run: echo "ğŸ‰ ãƒ‡ãƒ¼ã‚¿å–å¾—ã¨æ›´æ–°ãŒå®Œäº†ã—ã¾ã—ãŸï¼"
